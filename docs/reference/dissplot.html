<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Visualizes a dissimilarity matrix using seriation and matrix shading using
the method developed by Hahsler and Hornik (2011). Entries with lower
dissimilarities (higher similarity) are plotted darker. Dissimilarity plots
can be used to uncover hidden structure in the data and judge cluster
quality."><title>Dissimilarity Plot — dissplot • seriation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dissimilarity Plot — dissplot"><meta property="og:description" content="Visualizes a dissimilarity matrix using seriation and matrix shading using
the method developed by Hahsler and Hornik (2011). Entries with lower
dissimilarities (higher similarity) are plotted darker. Dissimilarity plots
can be used to uncover hidden structure in the data and judge cluster
quality."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">seriation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mhahsler/seriation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Dissimilarity Plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/dissplot.R" class="external-link"><code>R/dissplot.R</code></a>, <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/ggdissplot.R" class="external-link"><code>R/ggdissplot.R</code></a></small>
      <div class="d-none name"><code>dissplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Visualizes a dissimilarity matrix using seriation and matrix shading using
the method developed by Hahsler and Hornik (2011). Entries with lower
dissimilarities (higher similarity) are plotted darker. Dissimilarity plots
can be used to uncover hidden structure in the data and judge cluster
quality.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">dissplot</span><span class="op">(</span>
  <span class="va">x</span>,
  labels <span class="op">=</span> <span class="cn">NULL</span>,
  method <span class="op">=</span> <span class="st">"Spectral"</span>,
  control <span class="op">=</span> <span class="cn">NULL</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  upper_tri <span class="op">=</span> <span class="st">"average"</span>,
  diag <span class="op">=</span> <span class="cn">TRUE</span>,
  cluster_labels <span class="op">=</span> <span class="cn">TRUE</span>,
  cluster_lines <span class="op">=</span> <span class="cn">TRUE</span>,
  reverse_columns <span class="op">=</span> <span class="cn">FALSE</span>,
  options <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for reordered_cluster_dissimilarity_matrix</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>
  <span class="va">x</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  upper_tri <span class="op">=</span> <span class="st">"average"</span>,
  diag <span class="op">=</span> <span class="cn">TRUE</span>,
  options <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for reordered_cluster_dissimilarity_matrix</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">ggdissplot</span><span class="op">(</span>
  <span class="va">x</span>,
  labels <span class="op">=</span> <span class="cn">NULL</span>,
  method <span class="op">=</span> <span class="st">"Spectral"</span>,
  control <span class="op">=</span> <span class="cn">NULL</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  upper_tri <span class="op">=</span> <span class="st">"average"</span>,
  diag <span class="op">=</span> <span class="cn">TRUE</span>,
  cluster_labels <span class="op">=</span> <span class="cn">TRUE</span>,
  cluster_lines <span class="op">=</span> <span class="cn">TRUE</span>,
  reverse_columns <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>an object of class <a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a>.</p></dd>


<dt>labels</dt>
<dd><p><code>NULL</code> or an integer vector of the same length as
rows/columns in <code>x</code> indicating the cluster membership for each object
in <code>x</code> as consecutive integers starting with one. The labels are used
to reorder the matrix.</p></dd>


<dt>method</dt>
<dd><p>A single character string indicating the seriation method used
to reorder the clusters (inter cluster seriation) as well as the objects
within each cluster (intra cluster seriation).  If different algorithms for
inter and intra cluster seriation are required, <code>method</code> can be a
<code>list</code> of two named elements (<code>inter_cluster</code> and
<code>intra_cluster</code> each containing the name of the respective seriation
method. Use <code><a href="registry_seriate.html">list_seriation_methods()</a></code> with <code>kind = "dist"</code> to find available algorithms.</p>
<p>Set method to <code>NA</code> to plot the matrix as is (no or, if cluster labels
are supplied, only coarse seriation). For intra cluster reordering with the
special method <code>"silhouette width"</code> is available (for <code>dissplot()</code>
only). Objects in clusters are then ordered by silhouette width (from
silhouette plots).  If no <code>method</code> is given, the default method of
<code><a href="seriate.html">seriate.dist()</a></code> is used.</p>
<p>A third list element (named <code>aggregation</code>) can be added to control how
inter cluster dissimilarities are computed from from the given dissimilarity
matrix. The choices are <code>"avg"</code> (average pairwise dissimilarities;
average-link), <code>"min"</code> (minimal pairwise dissimilarities; single-link),
<code>"max"</code> (maximal pairwise dissimilarities; complete-link), and
<code>"Hausdorff"</code> (pairs up each point from one cluster with the most
similar point from the other cluster and then uses the largest dissimilarity
of paired up points).</p></dd>


<dt>control</dt>
<dd><p>a list of control options passed on to the seriation
algorithm.  In case of two different seriation algorithms, <code>control</code>
can contain a list of two named elements (<code>inter_cluster</code> and
<code>intra_cluster</code>) containing each a list with the control options for
the respective algorithm.</p></dd>


<dt>upper_tri, lower_tri, diag</dt>
<dd><p>a logical indicating whether to show the upper triangle, the
lower triangle or the diagonal of the distance matrix. The string "average" can also be used
to display within and between cluster averages in the two triangles.</p></dd>


<dt>cluster_labels</dt>
<dd><p>a logical indicating whether to display cluster labels
in the plot.</p></dd>


<dt>cluster_lines</dt>
<dd><p>a logical indicating whether to draw lines to separate
clusters.</p></dd>


<dt>reverse_columns</dt>
<dd><p>a logical indicating if the clusters are displayed on
the diagonal from north-west to south-east (<code>FALSE</code>; default) or from
north-east to south-west (<code>TRUE</code>).</p></dd>


<dt>options</dt>
<dd><p>a list with options for plotting the matrix (<code>dissplot</code>
only).</p><ul><li><p><code>plot</code> a logical indicating if a plot should
be produced.  if <code>FALSE</code>, the returned object can be plotted later
using the function <code>plot</code> which takes as the second argument a list of
plotting options (see <code>options</code> below).</p></li>
<li><p><code>silhouettes</code> a logical indicating whether to include a silhouette plot
(see Rousseeuw, 1987).</p></li>
<li><p><code>threshold</code> a numeric. If used, only plot distances
below the threshold are displayed. Consider also using <code>zlim</code> for this
purpose.</p></li>
<li><p><code>col</code> colors used for the image plot.</p></li>
<li><p><code>key</code> a logical indicating whether to place a color key below the plot.</p></li>
<li><p><code>zlim</code> range of values to display (defaults to range <code>x</code>).</p></li>
<li><p><code>axes</code> <code>"auto"</code> (default; enabled for less than 25 objects), <code>"y"</code> or <code>"none"</code>.</p></li>
<li><p><code>main</code> title for the plot.</p></li>
<li><p><code>newpage</code> a logical indicating whether to start plot on a new page
(see <code><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage()</a></code>.</p></li>
<li><p><code>pop</code> a logical indicating whether to pop the created viewports?
(see package <span class="pkg">grid</span>)</p></li>
<li><p><code>gp</code>, <code>gp_lines</code>, <code>gp_labels</code> objects of class <code>gpar</code> containing graphical parameters for the plot
lines and labels (see <code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar()</a></code>.</p></li>
</ul></dd>


<dt>...</dt>
<dd><p><code>dissplot()</code>: further arguments are added to <code>options</code>.
<code>ggdissplot()</code> further arguments are passed on to <code><a href="pimage.html">ggpimage()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>dissplot()</code> returns an invisible object of class
<code>cluster_proximity_matrix</code> with the following elements:</p>
<dl><dt>order</dt>
<dd><p><code>NULL</code> or integer vector giving the order used to plot <code>x</code>.</p></dd>

<dt>cluster_order</dt>
<dd><p><code>NULL</code> or integer vector giving the order of the
clusters as plotted.</p></dd>

<dt>method</dt>
<dd><p>vector of character strings indicating
the seriation methods used for plotting <code>x</code>.</p></dd>

<dt>k</dt>
<dd><p><code>NULL</code> or integer scalar giving the number of clusters generated.</p></dd>

<dt>description</dt>
<dd><p>a <code>data.frame</code> containing information (label, size, average
intra-cluster dissimilarity and the average silhouette) for the clusters as
displayed in the plot (from top/left to bottom/right).</p></dd>


</dl><p>This object can be used for plotting via <code>plot(x, options = NULL, ...)</code>,
where <code>x</code> is the object and <code>options</code> contains a list with
plotting options (see above).</p>


<p><code>ggdissplot()</code> returns a ggplot2 object representing the plot.</p>


<p>The plot description as an object of class <code>reordered_cluster_dissimilarity_matrix</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The plot can also be used to visualize cluster quality (see Ling 1973).
Objects belonging to the same cluster are displayed in consecutive order.
The placement of clusters and the within cluster order is obtained by a
seriation algorithm which tries to place large similarities/small
dissimilarities close to the diagonal. Compact clusters are visible as dark
squares (low dissimilarity) on the diagonal of the plot. Additionally, a
Silhouette plot (Rousseeuw 1987) is added. This visualization is similar to
CLUSION (see Strehl and Ghosh 2002), however, allows for using arbitrary
seriating algorithms.</p>
<p><strong>Note:</strong> Since <code><a href="pimage.html">pimage()</a></code> uses <span class="pkg">grid</span>, it should not be mixed
with base R primitive plotting functions.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hahsler, M. and Hornik, K. (2011): Dissimilarity plots: A visual
exploration tool for partitional clustering. <em>Journal of Computational
and Graphical Statistics,</em> <b>10</b>(2):335--354.
<a href="https://doi.org/10.1198/jcgs.2010.09139" class="external-link">doi:10.1198/jcgs.2010.09139</a></p>
<p>Ling, R.F. (1973): A computer generated aid for cluster analysis.
<em>Communications of the ACM,</em> <b>16</b>(6), 355--361.
<a href="https://doi.org/10.1145/362248.362263" class="external-link">doi:10.1145/362248.362263</a></p>
<p>Rousseeuw, P.J. (1987): Silhouettes: A graphical aid to the interpretation
and validation of cluster analysis. <em>Journal of Computational and
Applied Mathematics,</em> <b>20</b>(1), 53--65.
<a href="https://doi.org/10.1016/0377-0427%2887%2990125-7" class="external-link">doi:10.1016/0377-0427(87)90125-7</a></p>
<p>Strehl, A. and Ghosh, J. (2003): Relationship-based clustering and
visualization for high-dimensional data mining. <em>INFORMS Journal on
Computing,</em> <b>15</b>(2), 208--230.
<a href="https://doi.org/10.1287/ijoc.15.2.208.14448" class="external-link">doi:10.1287/ijoc.15.2.208.14448</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other plots: 
<code><a href="VAT.html">VAT</a>()</code>,
<code><a href="bertinplot.html">bertinplot</a>()</code>,
<code><a href="hmap.html">hmap</a>()</code>,
<code><a href="palette.html">palette</a>()</code>,
<code><a href="pimage.html">pimage</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Hahsler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># shuffle rows</span></span>
<span class="r-in"><span class="va">x_iris</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x_iris</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot original matrix</span></span>
<span class="r-in"><span class="fu">dissplot</span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span class="r-plt img"><img src="dissplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot reordered matrix using the nearest insertion algorithm (from tsp)</span></span>
<span class="r-in"><span class="fu">dissplot</span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">"TSP"</span>, main <span class="op">=</span> <span class="st">"Seriation (TSP)"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="dissplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Cluster iris with k-means and 3 clusters and reorder the dissimality matrix</span></span>
<span class="r-in"><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">x_iris</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span class="r-in"><span class="fu">dissplot</span><span class="op">(</span><span class="va">d</span>, labels <span class="op">=</span> <span class="va">l</span>, main <span class="op">=</span> <span class="st">"k-means"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="dissplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># show only distances as lower triangle</span></span>
<span class="r-in"><span class="fu">dissplot</span><span class="op">(</span><span class="va">d</span>, labels <span class="op">=</span> <span class="va">l</span>, main <span class="op">=</span> <span class="st">"k-means"</span>, lower_tri <span class="op">=</span> <span class="cn">TRUE</span>, upper_tri <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="dissplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use a grid layout to place several plots on a page</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"grid"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.layout.html" class="external-link">grid.layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">    gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>layout.pos.row <span class="op">=</span> <span class="fl">1</span>, layout.pos.col <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Visualize the clustering (using Spectral between clusters and MDS within)</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">dissplot</span><span class="op">(</span><span class="va">d</span>, <span class="va">l</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inter <span class="op">=</span> <span class="st">"Spectral"</span>, intra <span class="op">=</span> <span class="st">"MDS"</span><span class="op">)</span>,</span>
<span class="r-in">  main <span class="op">=</span> <span class="st">"K-Means + Seriation"</span>, newpage <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>layout.pos.row <span class="op">=</span> <span class="fl">1</span>, layout.pos.col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># More visualization options. Note that we reuse the reordered object res!</span></span>
<span class="r-in"><span class="co"># color: use 10 shades red-blue, biased towards small distances</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, main <span class="op">=</span> <span class="st">"K-Means + Seriation (red-blue + biased)"</span>,</span>
<span class="r-in">    col<span class="op">=</span> <span class="fu"><a href="palette.html">bluered</a></span><span class="op">(</span><span class="fl">10</span>, bias <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>, newpage <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>layout.pos.row <span class="op">=</span> <span class="fl">2</span>, layout.pos.col <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Threshold (using zlim) and cubic scale to highlight differences</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, main <span class="op">=</span> <span class="st">"K-Means + Seriation (cubic + threshold)"</span>,</span>
<span class="r-in">    zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="palette.html">grays</a></span><span class="op">(</span><span class="fl">100</span>, power <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, newpage <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>layout.pos.row <span class="op">=</span> <span class="fl">2</span>, layout.pos.col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use gray scale with logistic transformation</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, main <span class="op">=</span> <span class="st">"K-Means + Seriation (logistic scale)"</span>,</span>
<span class="r-in">  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">x_reordered</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">x_reordered</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span class="r-in">      location <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">)</span>,</span>
<span class="r-in">  newpage <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-plt img"><img src="dissplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The reordered_cluster_dissimilarity_matrix object</span></span>
<span class="r-in"><span class="va">res</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> object of class 'reordered_cluster_dissimilarity_matrix'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matrix dimensions: 150 x 150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dissimilarity measure: 'euclidean'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of clusters k: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cluster description</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   position label size aggregated_dissimilarity avg_silhouette_width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        1     1   38                1.0229060            0.4511051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        2     2   62                1.0338691            0.4173199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        3     3   50                0.6968169            0.7981405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> used seriation methods</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> inter-cluster: 'Spectral'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> intra-cluster: 'MDS'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dissimilarity aggregation method: 'avg'</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "x_reordered"             "labels"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "seriation_methods"       "aggregation_method"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "k"                       "cluster_dissimilarities"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "sil"                     "order"                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "cluster_order"           "diss_measure"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "description"            </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## --------------------------------------------------------------------</span></span>
<span class="r-in"><span class="co">## ggplot-based dissplot</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot original matrix</span></span>
<span class="r-in"><span class="fu">ggdissplot</span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot seriated matrix</span></span>
<span class="r-in"><span class="fu">ggdissplot</span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">"TSP"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Seriation (TSP)"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Cluster iris with k-means and 3 clusters</span></span>
<span class="r-in"><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></span><span class="op">(</span><span class="va">x_iris</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">ggdissplot</span><span class="op">(</span><span class="va">d</span>, labels <span class="op">=</span> <span class="va">l</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means + Seriation"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># show only lower triangle</span></span>
<span class="r-in"><span class="fu">ggdissplot</span><span class="op">(</span><span class="va">d</span>, labels <span class="op">=</span> <span class="va">l</span>, lower_tri <span class="op">=</span> <span class="cn">TRUE</span>, upper_tri <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means + Seriation"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># No lines or cluster labels and add a label for the color key (fill)</span></span>
<span class="r-in"><span class="fu">ggdissplot</span><span class="op">(</span><span class="va">d</span>, labels <span class="op">=</span> <span class="va">l</span>, cluster_lines <span class="op">=</span> <span class="cn">FALSE</span>, cluster_labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-means + Seriation"</span>, fill <span class="op">=</span> <span class="st">"Distances\n(Euclidean)"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Diverging color palette with manual set midpoint and different seriation methods</span></span>
<span class="r-in"><span class="fu">ggdissplot</span><span class="op">(</span><span class="va">d</span>, <span class="va">l</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inter <span class="op">=</span> <span class="st">"Spectral"</span>, intra <span class="op">=</span> <span class="st">"MDS"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means + Seriation"</span>, subtitle <span class="op">=</span> <span class="st">"biased color scale"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>midpoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use manipulate scale using package scales</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://scales.r-lib.org" class="external-link">"scales"</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Threshold (using limit and na.value) and cubic scale to highlight differences</span></span>
<span class="r-in"><span class="va">cubic_dist_trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://scales.r-lib.org/reference/trans_new.html" class="external-link">trans_new</a></span><span class="op">(</span></span>
<span class="r-in">  name <span class="op">=</span> <span class="st">"cubic"</span>,</span>
<span class="r-in">  <span class="co"># note that we have to do the inverse transformation for distances</span></span>
<span class="r-in">  trans <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span class="r-in">  inverse <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">ggdissplot</span><span class="op">(</span><span class="va">d</span>, <span class="va">l</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inter <span class="op">=</span> <span class="st">"Spectral"</span>, intra <span class="op">=</span> <span class="st">"MDS"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means + Seriation"</span>, subtitle <span class="op">=</span> <span class="st">"cubic + biased color scale"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"white"</span>,</span>
<span class="r-in">    limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"white"</span>,</span>
<span class="r-in">    trans <span class="op">=</span> <span class="va">cubic_dist_trans</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use gray scale with logistic transformation</span></span>
<span class="r-in"><span class="va">logis_2_.5_dist_trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://scales.r-lib.org/reference/trans_new.html" class="external-link">trans_new</a></span><span class="op">(</span></span>
<span class="r-in">  name <span class="op">=</span> <span class="st">"Logistic transform (location, scale)"</span>,</span>
<span class="r-in">  <span class="co"># note that we have to do the inverse transformation for distances</span></span>
<span class="r-in">  trans <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">x</span>, location <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">.5</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span class="r-in">  inverse <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="va">x</span>, location <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">.5</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">ggdissplot</span><span class="op">(</span><span class="va">d</span>, <span class="va">l</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>inter <span class="op">=</span> <span class="st">"Spectral"</span>, intra <span class="op">=</span> <span class="st">"MDS"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means + Seriation"</span>, subtitle <span class="op">=</span> <span class="st">"logistic color scale"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"white"</span>,</span>
<span class="r-in">    trans <span class="op">=</span> <span class="va">logis_2_.5_dist_trans</span>,</span>
<span class="r-in">    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> will replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> will replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> will replace the existing scale.</span>
<span class="r-plt img"><img src="dissplot-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Hahsler, Christian Buchta, Kurt Hornik.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

