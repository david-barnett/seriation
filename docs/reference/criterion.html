<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute the value for different loss functions \(L\) and merit function
\(M\) for data given a permutation."><title>Criterion for a Loss/Merit Function for Data Given a Permutation — criterion • seriation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Criterion for a Loss/Merit Function for Data Given a Permutation — criterion"><meta property="og:description" content="Compute the value for different loss functions \(L\) and merit function
\(M\) for data given a permutation."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">seriation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mhahsler/seriation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Criterion for a Loss/Merit Function for Data Given a Permutation</h1>
      <small class="dont-index">Source: <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/criterion.R" class="external-link"><code>R/criterion.R</code></a>, <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/criterion.array.R" class="external-link"><code>R/criterion.array.R</code></a>, <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/criterion.dist.R" class="external-link"><code>R/criterion.dist.R</code></a>, and 1 more</small>
      <div class="d-none name"><code>criterion.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the value for different loss functions \(L\) and merit function
\(M\) for data given a permutation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">criterion</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="cn">NULL</span>, force_loss <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for array</span>
<span class="fu">criterion</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="cn">NULL</span>, force_loss <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for dist</span>
<span class="fu">criterion</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="cn">NULL</span>, force_loss <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for matrix</span>
<span class="fu">criterion</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="cn">NULL</span>, force_loss <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>an object of class <a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a> or a matrix (currently no functions
are implemented for array).</p></dd>


<dt>order</dt>
<dd><p>an object of class <a href="ser_permutation.html">ser_permutation</a> suitable for
<code>x</code>.  If <code>NULL</code>, the identity permutation is used.</p></dd>


<dt>method</dt>
<dd><p>a character vector with the names of the criteria to be
employed (see <code><a href="registry_criterion.html">list_criterion_methods()</a></code>), or <code>NULL</code> (default) in which case all available criteria are
used.</p></dd>


<dt>force_loss</dt>
<dd><p>logical; should merit function be converted into loss
functions by multiplying with -1?</p></dd>


<dt>...</dt>
<dd><p>additional parameters passed on to the criterion method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A named vector of real values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Criteria for distance matrices (dist)</strong></p>
<p>For a symmetric dissimilarity matrix \(D\) with elements \(d(i,j)\)
where \(i, j = 1 \ldots n\), the aim is generally to place low distance
values close to the diagonal. The following criteria to judge the quality of
a certain permutation of the objects in a dissimilarity matrix are currently
implemented (for a more detailed description and an experimental comparison
see Hahsler (2017)):</p><ul><li><p>"Gradient_raw", "Gradient_weighted" Gradient measures
(Hubert et al 2001).  A symmetric dissimilarity matrix where the values in
all rows and columns only increase when moving away from the main diagonal
is called a perfect <em>anti-Robinson matrix</em> (Robinson 1951). A suitable
merit measure which quantifies the divergence of a matrix from the
anti-Robinson form is
$$ M(D) = \sum_{i=1}^n \sum_{i&lt;k&lt;j} f(d_{ij}, d_{ik}) + \sum_{i&lt;k&lt;j}
    f(d_{ij}, d_{kj})$$ where \(f(.,.)\) is a function which defines how a
violation or satisfaction of a gradient condition for an object triple
(\(O_i, O_k, O_j\)) is counted.</p>
<p>Hubert et al (2001) suggest two functions. The first function is given by:
$$f(z,y) = sign(y-z) = +1 if z &lt; y; 0 if z = y; and -1 if z &gt; y.$$</p>
<p>It results in raw number of triples satisfying the gradient constraints
minus triples which violate the constraints.</p>
<p>The second function is defined as: $$f(z,y) = |y-z| sign(y-z) = y-z$$ It
weights the each satisfaction or violation by the difference by its
magnitude given by the absolute difference between the values.</p></li>
<li><p>"AR_events", "AR_deviations" Anti-Robinson events (Chen
2002).  An even simpler loss function can be created in the same way as the
gradient measures above by concentrating on violations only.
$$ L(D) = \sum_{i=1}^n \sum_{i&lt;k&lt;j} f(d_{ik}, d_{ij}) + \sum_{i&lt;k&lt;j} f(d_{kj}, d_{ij})$$</p>
<p>To only count the violations we use
$$ f(z, y) = I(z, y) = 1 if z &lt; y and 0 otherwise.$$</p>
<p>\(I(.)\) is an indicator function returning 1 only for violations.
Chen (2002) presented a formulation for an equivalent loss function and
called the violations <em>anti-Robinson events</em> and also introduced a
weighted versions of the loss function resulting in
$$ f(z, y) = |y-z|I(z, y) $$ using the absolute deviations as weights.</p></li>
<li><p>"RGAR" Relative generalized Anti-Robinson events (Tien et
al 2008).  Counts Anti-Robinson events in a variable band (window specified
by <code>w</code> defaults to the maximum of \(n-1\)) around the main diagonal
and normalizes by the maximum of possible events.</p>
<p>$$ L(D) = 1/m \sum_{i=1}^n \sum_{(i-w)\le j&lt;k&lt;i} I(d_{ij} &lt; d_{ik}) +
    \sum_{i&lt;j&lt;k\le(i+w))} I(d_{ij} &gt; d_{ik}) $$</p>
<p>where \(m=(2/3-n)w + nw^2 - 2/3 w^3\), the maximal number of possible
anti-Robinson events in the window.  The window size \(w\) represents the
number of neighboring objects (number of entries from the diagonal of the
distance matrix) are considered. The window size is \(2 \le w &lt; n\), where
smaller values result in focusing on the local structure while larger values
look at the global structure. Alternatively, <code>pct</code> can be used instead
of <code>w</code> to specify the window as a percentage of \(n\).
<code>relative = FALSE</code> can be to get the GAR, i.e., the absolute number of AR
events in the window.</p></li>
<li><p>"BAR" Banded Anti-Robinson Form (Earle and Hurley 2015).</p>
<p>Simplified measure for closeness to the anti-Robinson form in a band of size
\(b\) with \(1 &lt;= b &lt; n\) around the diagonal.</p>
<p>$$ L(D) = \sum_{|i-j|&lt;=b} (b+1-|i-j|) d_{ij} $$</p>
<p>For \(b = 1\) the measure reduces to the Hamiltonian path length.  For
\(b = n-1\) the measure is equivalent to ARc defined (Earle and Hurley,
2015). Note that ARc is equivalent to the Linear Seriation criterion (scaled
by 1/2).</p>
<p>\(b\) defaults to a band of 20% of \(n\).</p></li>
<li><p>"Path_length" Hamiltonian path length (Caraux and Pinloche 2005).</p>
<p>The order of the objects in a dissimilarity matrix corresponds to a path
through a graph where each node represents an object and is visited exactly
once, i.e., a Hamilton path. The length of the path is defined as the sum of
the edge weights, i.e., dissimilarities.</p>
<p>$$L(D) = \sum_{i=1}^{n-1} d_{i,i+1}$$</p>
<p>The length of the Hamiltonian path is equal to the value of the minimal span
loss function (as used by Chen 2002).  Both notions are related to the
<em>traveling salesperson problem (TSP).</em></p>
<p>If <code>order</code> is not unique or there are non-finite distance values
<code>NA</code> is returned.</p></li>
<li><p>"Lazy_path_length" Lazy path length (Earl and Hurley 2015).</p>
<p>A weighted version of the Hamiltonian path criterion. This loss function
postpones larger distances to later in the order (i.e., a lazy traveling
sales person).</p>
<p>$$L(D) = \sum_{i=1}^{n-1} (n-i) d_{i,i+1}$$</p>
<p>Earl and Hurley (2015) proposed this criterion for reordering in
visualizations to concentrate on closer objects first.</p></li>
<li><p>"Inertia" Inertia criterion (Caraux and Pinloche 2005).</p>
<p>Measures the moment of the inertia of dissimilarity values around the
diagonal as</p>
<p>$$M(D) = \sum_{i=1}^n \sum_{j=1}^n d(i,j)|i-j|^2$$</p>
<p>\(|i-j|\) is used as a measure for the distance to the diagonal and
\(d(i,j)\) gives the weight. This criterion gives higher weight to values
farther away from the diagonal. It increases with quality.</p></li>
<li><p>"Least_squares" Least squares criterion (Caraux and Pinloche 2005).</p>
<p>The sum of squares of deviations between the dissimilarities and rank
differences (in the matrix) between two elements: $$L(D) = \sum_{i=1}^n
  \sum_{j=1}^n (d(i,j) - |i-j|)^2,$$ where \(d(i,j)\) is an element of the
dissimilarity matrix \(D\) and \(|i-j|\) is the rank difference between
the objects.</p>
<p>Note that if Euclidean distance is used to calculate \(D\) from a data
matrix \(X\), the order of the elements in \(X\) by projecting them on
the first principal component of \(X\) minimizes this criterion.  The
least squares criterion is related to <em>unidimensional scaling.</em></p></li>
<li><p>"LS" Linear Seriation Criterion (Hubert and Schultz 1976).</p>
<p>Weights the distances with the absolute rank differences.</p>
<p>$$L(D) \sum_{i,j=1}^n d(i,j) (-|i-j|)$$</p></li>
<li><p>"2SUM" 2-Sum Criterion (Barnard, Pothen, and Simon 1993).</p>
<p>The 2-Sum loss criterion multiplies the similarity between objects with the
squared rank differences.</p>
<p>$$L(D) \sum_{i,j=1}^n 1/(1+d(i,j)) (i-j)^2,$$</p>
<p>where \(s(i,j) = 1/(1+d(i,j))\) represents the similarity between objects
\(i\) and \(j\).</p></li>
<li><p>"ME", "Moore_stress", "Neumann_stress", "Cor_R" These criteria are defined on general matrices (see
below for definitions).  The dissimilarity matrix is first converted into a
similarity matrix using \(S = 1/(1+D)\). If a different transformation is
required, then perform the transformation first and supply a matrix instead
of a dist object.</p></li>
</ul><p><strong>Criteria for matrices (matrix)</strong></p>
<p>For a general matrix \(X = x_{ij}\), \(i = 1 \ldots n\) and
\(j = 1 \ldots m\), currently the following loss/merit functions are implemented:</p><ul><li><p>"ME" Measure of Effectiveness (McCormick 1972).</p>
<p>The measure of effectiveness (ME) for matrix \(X\), is defined as</p>
<p>$$M(X) = 1/2 \sum_{i=1}^{n} \sum_{j=1}^{m}
    x_{i,j}(x_{i,j-1}+x_{i,j+1}+x_{i-1,j}+x_{i+1,j})$$</p>
<p>with, by convention</p>
<p>$$x_{0,j}=x_{m+1,j}=x_{i,0}=x_{i,n+1}=0.$$</p>
<p>ME is a merit measure, i.e. a higher ME indicates a better arrangement.
Maximizing ME is the objective of the bond energy algorithm (BEA). ME is not
defined for matrices with negative values. <code>NA</code> is returned in this
case.</p></li>
<li><p>"Cor_R" Weighted correlation coefficient R developed as the
Measure of Effectiveness for the Moment Ordering Algorithm (Deutsch and
Martin 1971).</p>
<p>R is a merit measure normalized so that its value always lies in
\([-1,1]\).  For the special case of a square matrix \(R=1\) corresponds
to only the main diagonal being filled, \(R=0\) to a random distribution
of value throughout the array, and \(R=-1\) to the opposite diagonal only
being filled.</p></li>
<li><p>"Moore_stress" Stress (Niermann 2005).</p>
<p>Stress measures the conciseness of the presentation of a matrix/table and
can be seen as a purity function which compares the values in a matrix/table
with its neighbors. The stress measure used here is computed as the sum of
squared distances of each matrix entry from its adjacent entries.</p>
<p>$$ L(X) = \sum_{i=1}^n \sum_{j=1}^m \sigma_{ij} $$</p>
<p>The following types of neighborhoods are available:</p><ul><li><p>Moore: comprises the eight adjacent entries.
$$
     \sigma_{ij} = \sum_{k=\max(1,i-1)}^{\min(n,i+1)}
     \sum_{l=\max(1,j-1)}^{\min(m,j+1)} (x_{ij} - x_{kl})^2 $$</p></li>
<li><p>Neumann: comprises the four adjacent entries.  $$ \sigma_{ij} =
     \sum_{k=\max(1,i-1)}^{\min(n,i+1)} (x_{ij} - x_{kj})^2 +
     \sum_{l=\max(1,j-1)}^{\min(m,j+1)} (x_{ij} - x_{il})^2 $$</p></li>
</ul><p>The major difference between the Moore and the Neumann neighborhood is that
for the later the contribution of row and column permutations to stress are
independent and thus can be optimized independently.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Barnard, S.T., A. Pothen, and H. D. Simon (1993): A Spectral
Algorithm for Envelope Reduction of Sparse Matrices. <em>In Proceedings of
the 1993 ACM/IEEE Conference on Supercomputing,</em> 493--502. Supercomputing
'93. New York, NY, USA: ACM.</p>
<p>Caraux, G. and S. Pinloche (2005): Permutmatrix: A Graphical Environment to
Arrange Gene Expression Profiles in Optimal Linear Order,
<em>Bioinformatics,</em> <b>21</b>(7), 1280--1281.</p>
<p>Chen, C.-H. (2002): Generalized association plots: Information visualization
via iteratively generated correlation matrices, <em>Statistica Sinica,</em>
<b>12</b>(1), 7--29.</p>
<p>Deutsch, S.B. and J.J. Martin (1971): An ordering algorithm for analysis of
data arrays. <em>Operational Research,</em> <b>19</b>(6), 1350--1362.
<a href="https://doi.org/10.1287/opre.19.6.1350" class="external-link">doi:10.1287/opre.19.6.1350</a></p>
<p>Earle, D. and C.B. Hurley (2015): Advances in Dendrogram Seriation for
Application to Visualization. <em>Journal of Computational and Graphical
Statistics,</em> <b>24</b>(1), 1--25.
<a href="https://doi.org/10.1080/10618600.2013.874295" class="external-link">doi:10.1080/10618600.2013.874295</a></p>
<p>Hahsler, M. (2017): An experimental comparison of seriation methods for
one-mode two-way data. <em>European Journal of Operational Research,</em>
<b>257</b>, 133--143.
<a href="https://doi.org/10.1016/j.ejor.2016.08.066" class="external-link">doi:10.1016/j.ejor.2016.08.066</a></p>
<p>Hubert, L. and J. Schultz (1976): Quadratic Assignment as a General Data
Analysis Strategy. <em>British Journal of Mathematical and Statistical
Psychology,</em> <b>29</b>(2). Blackwell Publishing Ltd. 190--241.
<a href="https://doi.org/10.1111/j.2044-8317.1976.tb00714.x" class="external-link">doi:10.1111/j.2044-8317.1976.tb00714.x</a></p>
<p>Hubert, L., P. Arabie, and J. Meulman (2001): <em>Combinatorial Data
Analysis: Optimization by Dynamic Programming.</em> Society for Industrial
Mathematics.
<a href="https://doi.org/10.1137/1.9780898718553" class="external-link">doi:10.1137/1.9780898718553</a></p>
<p>Niermann, S. (2005): Optimizing the Ordering of Tables With Evolutionary
Computation, <em>The American Statistician,</em> <b>59</b>(1), 41--46.
<a href="https://doi.org/10.1198/000313005X22770" class="external-link">doi:10.1198/000313005X22770</a></p>
<p>McCormick, W.T., P.J. Schweitzer and T.W. White (1972): Problem
decomposition and data reorganization by a clustering technique,
<em>Operations Research,</em> <b>20</b>(5), 993-1009.
<a href="https://doi.org/10.1287/opre.20.5.993" class="external-link">doi:10.1287/opre.20.5.993</a></p>
<p>Robinson, W.S. (1951): A method for chronologically ordering archaeological
deposits, <em>American Antiquity,</em> <b>16</b>, 293--301.
<a href="https://doi.org/10.2307/276978" class="external-link">doi:10.2307/276978</a></p>
<p>Tien, Y-J., Yun-Shien Lee, Han-Ming Wu and Chun-Houh Chen (2008): Methods
for simultaneously identifying coherent local clusters with smooth global
patterns in gene expression profiles, <em>BMC Bioinformatics,</em>
<b>9</b>(155), 1--16.
<a href="https://doi.org/10.1186/1471-2105-9-155" class="external-link">doi:10.1186/1471-2105-9-155</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other criterion: 
<code><a href="registry_criterion.html">registry_criterion</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Hahsler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## create random data and calculate distances</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## get an order for rows (optimal for the least squares criterion)</span></span>
<span class="r-in"><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">"MDS"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">o</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> object of class ‘ser_permutation’, ‘list’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> contains permutation vectors for 1-mode data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector length seriation method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            10              MDS</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## compare the values for all available criteria</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span class="r-in">    unordered <span class="op">=</span> <span class="fu">criterion</span><span class="op">(</span><span class="va">d</span><span class="op">)</span>,</span>
<span class="r-in">    ordered <span class="op">=</span> <span class="fu">criterion</span><span class="op">(</span><span class="va">d</span>, <span class="va">o</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2SUM AR_deviations AR_events      BAR      Cor_R Gradient_raw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unordered 1050.9410     28.608090       133 15.46688 0.07664217          -26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordered    959.9898      7.930161        55 10.52292 0.14411841          130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Gradient_weighted   Inertia       LS Lazy_path_length Least_squares</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unordered          5.515768  995.6601 324.1060         27.90263      1297.956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordered           47.864656 1221.5475 295.8734         17.29742      1241.491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 ME Moore_stress Neumann_stress Path_length      RGAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unordered 83.82401     28.11981       18.32070    5.550852 0.5541667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ordered   86.55243     17.11011       10.16886    3.526988 0.2291667</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## compare RGAR by window size (from local to global)</span></span>
<span class="r-in"><span class="va">w</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">RGAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">w</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">w</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu">criterion</span><span class="op">(</span><span class="va">d</span>, <span class="va">o</span>, method<span class="op">=</span><span class="st">"RGAR"</span>, w <span class="op">=</span> <span class="va">w</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">RGAR</span>, type <span class="op">=</span> <span class="st">"b"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span class="r-in">  xlab <span class="op">=</span> <span class="st">"Windows size (w)"</span>, main <span class="op">=</span> <span class="st">"RGAR by window size"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="criterion-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Hahsler, Christian Buchta, Kurt Hornik.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

