<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Provides methods for matrix shading, i.e., displaying a color image for
matrix (including correlation matrices) and dist objects given an
optional permutation.  The plot arranges colored rectangles to represent the
matrix value. Columns and rows appear in the order in the matrix.  This
visualization is also know asi a heatmap.  Implementations based on the
grid graphics engine and based n ggplot2 are provided."><title>Permutation Image Plot — pimage • seriation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Permutation Image Plot — pimage"><meta property="og:description" content="Provides methods for matrix shading, i.e., displaying a color image for
matrix (including correlation matrices) and dist objects given an
optional permutation.  The plot arranges colored rectangles to represent the
matrix value. Columns and rows appear in the order in the matrix.  This
visualization is also know asi a heatmap.  Implementations based on the
grid graphics engine and based n ggplot2 are provided."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">seriation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mhahsler/seriation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Permutation Image Plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/pimage.R" class="external-link"><code>R/pimage.R</code></a>, <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/ggpimage.R" class="external-link"><code>R/ggpimage.R</code></a></small>
      <div class="d-none name"><code>pimage.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides methods for matrix shading, i.e., displaying a color image for
matrix (including correlation matrices) and <code>dist</code> objects given an
optional permutation.  The plot arranges colored rectangles to represent the
matrix value. Columns and rows appear in the order in the matrix.  This
visualization is also know asi a heatmap.  Implementations based on the
<span class="pkg">grid</span> graphics engine and based n <span class="pkg">ggplot2</span> are provided.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">pimage</span><span class="op">(</span>
  <span class="va">x</span>,
  order <span class="op">=</span> <span class="cn">NULL</span>,
  col <span class="op">=</span> <span class="cn">NULL</span>,
  main <span class="op">=</span> <span class="st">""</span>,
  xlab <span class="op">=</span> <span class="st">""</span>,
  ylab <span class="op">=</span> <span class="st">""</span>,
  zlim <span class="op">=</span> <span class="cn">NULL</span>,
  key <span class="op">=</span> <span class="cn">TRUE</span>,
  keylab <span class="op">=</span> <span class="st">""</span>,
  symkey <span class="op">=</span> <span class="cn">TRUE</span>,
  upper_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  diag <span class="op">=</span> <span class="cn">TRUE</span>,
  row_labels <span class="op">=</span> <span class="cn">NULL</span>,
  col_labels <span class="op">=</span> <span class="cn">NULL</span>,
  prop <span class="op">=</span> <span class="cn">TRUE</span>,
  flip_axes <span class="op">=</span> <span class="cn">FALSE</span>,
  reverse_columns <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>,
  newpage <span class="op">=</span> <span class="cn">TRUE</span>,
  pop <span class="op">=</span> <span class="cn">TRUE</span>,
  gp <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S3 method for matrix</span>
<span class="fu">pimage</span><span class="op">(</span>
  <span class="va">x</span>,
  order <span class="op">=</span> <span class="cn">NULL</span>,
  col <span class="op">=</span> <span class="cn">NULL</span>,
  main <span class="op">=</span> <span class="st">""</span>,
  xlab <span class="op">=</span> <span class="st">""</span>,
  ylab <span class="op">=</span> <span class="st">""</span>,
  zlim <span class="op">=</span> <span class="cn">NULL</span>,
  key <span class="op">=</span> <span class="cn">TRUE</span>,
  keylab <span class="op">=</span> <span class="st">""</span>,
  symkey <span class="op">=</span> <span class="cn">TRUE</span>,
  upper_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  diag <span class="op">=</span> <span class="cn">TRUE</span>,
  row_labels <span class="op">=</span> <span class="cn">NULL</span>,
  col_labels <span class="op">=</span> <span class="cn">NULL</span>,
  prop <span class="op">=</span> <span class="cn">TRUE</span>,
  flip_axes <span class="op">=</span> <span class="cn">FALSE</span>,
  reverse_columns <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>,
  newpage <span class="op">=</span> <span class="cn">TRUE</span>,
  pop <span class="op">=</span> <span class="cn">TRUE</span>,
  gp <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="co"># S3 method for table</span>
<span class="fu">pimage</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for dist</span>
<span class="fu">pimage</span><span class="op">(</span>
  <span class="va">x</span>,
  order <span class="op">=</span> <span class="cn">NULL</span>,
  col <span class="op">=</span> <span class="cn">NULL</span>,
  main <span class="op">=</span> <span class="st">""</span>,
  xlab <span class="op">=</span> <span class="st">""</span>,
  ylab <span class="op">=</span> <span class="st">""</span>,
  zlim <span class="op">=</span> <span class="cn">NULL</span>,
  key <span class="op">=</span> <span class="cn">TRUE</span>,
  keylab <span class="op">=</span> <span class="st">""</span>,
  symkey <span class="op">=</span> <span class="cn">TRUE</span>,
  upper_tri <span class="op">=</span> <span class="cn">FALSE</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  diag <span class="op">=</span> <span class="cn">FALSE</span>,
  row_labels <span class="op">=</span> <span class="cn">NULL</span>,
  col_labels <span class="op">=</span> <span class="cn">NULL</span>,
  prop <span class="op">=</span> <span class="cn">TRUE</span>,
  flip_axes <span class="op">=</span> <span class="cn">FALSE</span>,
  reverse_columns <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>,
  newpage <span class="op">=</span> <span class="cn">TRUE</span>,
  pop <span class="op">=</span> <span class="cn">TRUE</span>,
  gp <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="fu">ggpimage</span><span class="op">(</span>
  <span class="va">x</span>,
  order <span class="op">=</span> <span class="cn">NULL</span>,
  zlim <span class="op">=</span> <span class="cn">NULL</span>,
  upper_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  diag <span class="op">=</span> <span class="cn">TRUE</span>,
  row_labels <span class="op">=</span> <span class="cn">NULL</span>,
  col_labels <span class="op">=</span> <span class="cn">NULL</span>,
  prop <span class="op">=</span> <span class="cn">TRUE</span>,
  flip_axes <span class="op">=</span> <span class="cn">FALSE</span>,
  reverse_columns <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="co"># S3 method for matrix</span>
<span class="fu">ggpimage</span><span class="op">(</span>
  <span class="va">x</span>,
  order <span class="op">=</span> <span class="cn">NULL</span>,
  zlim <span class="op">=</span> <span class="cn">NULL</span>,
  upper_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  diag <span class="op">=</span> <span class="cn">TRUE</span>,
  row_labels <span class="op">=</span> <span class="cn">NULL</span>,
  col_labels <span class="op">=</span> <span class="cn">NULL</span>,
  prop <span class="op">=</span> <span class="cn">TRUE</span>,
  flip_axes <span class="op">=</span> <span class="cn">FALSE</span>,
  reverse_columns <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="co"># S3 method for dist</span>
<span class="fu">ggpimage</span><span class="op">(</span>
  <span class="va">x</span>,
  order <span class="op">=</span> <span class="cn">NULL</span>,
  zlim <span class="op">=</span> <span class="cn">NULL</span>,
  upper_tri <span class="op">=</span> <span class="cn">FALSE</span>,
  lower_tri <span class="op">=</span> <span class="cn">TRUE</span>,
  diag <span class="op">=</span> <span class="cn">FALSE</span>,
  row_labels <span class="op">=</span> <span class="cn">NULL</span>,
  col_labels <span class="op">=</span> <span class="cn">NULL</span>,
  prop <span class="op">=</span> <span class="cn">TRUE</span>,
  flip_axes <span class="op">=</span> <span class="cn">FALSE</span>,
  reverse_columns <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a matrix or an object of class <code>dist</code>.</p></dd>


<dt>order</dt>
<dd><p>an object of class <code>ser_permutation</code> or the name of a seriation method.
If <code>NULL</code> the order in <code>x</code> is plotted.</p></dd>


<dt>col</dt>
<dd><p>a list of colors used. If <code>NULL</code>, a gray scale is used (for
matrix larger values are displayed darker and for <code>dist</code> smaller
distances are darker). For matrices containing logical data, black and white
is used. For matrices containing negative values a symmetric diverging color
palette is used.</p></dd>


<dt>main</dt>
<dd><p>plot title.</p></dd>


<dt>xlab, ylab</dt>
<dd><p>labels for the x and y axes.</p></dd>


<dt>zlim</dt>
<dd><p>vector with two elements giving the range (min, max) for
representing the values in the matrix.</p></dd>


<dt>key</dt>
<dd><p>logical; add a color key? No key is available for logical
matrices.</p></dd>


<dt>keylab</dt>
<dd><p>string plotted next to the color key.</p></dd>


<dt>symkey</dt>
<dd><p>logical; if <code>x</code> contains negative values, should the
color palate be symmetric (zero is in the middle)&gt;</p></dd>


<dt>upper_tri, lower_tri, diag</dt>
<dd><p>a logical indicating whether to show the
upper triangel, the lower triangle or the diagonal of the (distance) matrix.</p></dd>


<dt>row_labels, col_labels</dt>
<dd><p>a logical indicating if row and column labels
in <code>x</code> should be displayed.  If <code>NULL</code> then labels are displayed
if the <code>x</code> contains the appropriate dimname and the number of labels is
25 or less. A character vector of the appropriate length with labels can
also be supplied.</p></dd>


<dt>prop</dt>
<dd><p>logical; change the aspect ratio so cells in the image have a
equal width and height.</p></dd>


<dt>flip_axes</dt>
<dd><p>logical; exchange rows and columns for plotting.</p></dd>


<dt>reverse_columns</dt>
<dd><p>logical; revers the order of how the columns are
displayed.</p></dd>


<dt>...</dt>
<dd><p>further arguments are ignored.</p></dd>


<dt>newpage, pop, gp</dt>
<dd><p>Start plot on a new page, pop the viewports after
plotting, and use the supplied <code>gpar</code> object (see <span class="pkg">grid</span>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Nothing.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Plots a matrix in its original row and column orientation. This means, in a
plot the columns become the x-coordinates and the rows the y-coordinates (in
reverse order).</p>
<p>If <code>x</code> is of class <code>dist</code> it is converted to full-storage
representation before plotting.</p>
<p><b>Grid-based plot:</b> The viewports used for plotting are called:
<code>"plot"</code>, <code>"image"</code> and <code>"colorkey"</code>.  <em>Note:</em> Since
<code>pimage</code> uses <span class="pkg">grid</span>, it should not be mixed with base R primitive
plotting functions, but the appropriate functions in
<code><a href="https://rdrr.io/r/grid/grid-package.html" class="external-link">grid-package</a></code>.</p>
<p><b>ggplot2-based plot:</b> A ggplot2 object is returned. Colors, axis limits
and other visual aspects can be added using standard ggplot2 functions
(<code>labs</code>, <code>scale_fill_continuous</code>, <code>labs</code>, etc.).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other plots: 
<code><a href="VAT.html">VAT</a>()</code>,
<code><a href="bertinplot.html">bertinplot</a>()</code>,
<code><a href="dissplot.html">dissplot</a>()</code>,
<code><a href="hmap.html">hmap</a>()</code>,
<code><a href="palette.html">palette</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Christian Buchta and Michael Hahsler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Logical Matrix</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">300</span>, rep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Matrix for logical values. TRUE values are dark and no color key is shown. There are too many</span></span>
<span class="r-in"><span class="co"># Row labels (&gt;25) so they are suppressed.</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Show all labels and flip axes or reverse columns</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">x</span>, row_labels <span class="op">=</span> <span class="cn">TRUE</span>, col_labels <span class="op">=</span> <span class="cn">TRUE</span>, flip_axes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">x</span>, row_labels <span class="op">=</span> <span class="cn">TRUE</span>, col_labels <span class="op">=</span> <span class="cn">TRUE</span>, reverse_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Reorder matrix, use custom colors, and add a title.</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, row_labels <span class="op">=</span> <span class="cn">TRUE</span>, col_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Random Data (Reordered)"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Positive Matrix</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Pos/Neg. Matrix</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Distance Matrix</span></span>
<span class="r-in"><span class="co"># Show a reordered distance matrix (distances between rows).</span></span>
<span class="r-in"><span class="co"># Dark means low distance. The aspect ratio is automatically fixed to 1:1.</span></span>
<span class="r-in"><span class="co"># The upper triangle is suppressed triangle</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">d</span>,  order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>,</span>
<span class="r-in">  main <span class="op">=</span> <span class="st">"Random Data (Distances)"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Show only distances that are smaller than 4 using limits on z.</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">d</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>,</span>
<span class="r-in">  main <span class="op">=</span> <span class="st">"Random Data (Distances + Theshold)"</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-8.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Correlation Matrix</span></span>
<span class="r-in"><span class="co"># we calculate correlation between rows and seriate the matrix</span></span>
<span class="r-in"><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="permute.html">permute</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">r</span>, upper <span class="op">=</span> <span class="cn">FALSE</span>, diag <span class="op">=</span> <span class="cn">FALSE</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, reverse_columns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  main <span class="op">=</span> <span class="st">"Random Data (Correlation)"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-9.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Add to the plot using functions in package grid</span></span>
<span class="r-in"><span class="co"># Note: pop = FALSE allows us to manipulate viewports</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"grid"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">x</span>, pop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># available viewports are: "main", "colorkey", "plot", "image"</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/current.viewport.html" class="external-link">current.vpTree</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> viewport[ROOT]-&gt;(viewport[GRID.VP.304]-&gt;(viewport[GRID.VP.305]-&gt;(viewport[GRID.VP.306]-&gt;(viewport[colorkey]-&gt;(viewport[colorkey]), viewport[plot]-&gt;(viewport[image]))), viewport[main])) </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Highlight cell column 7 (G) / row 5 (from top)/col with a red arrow starting at 5/2</span></span>
<span class="r-in"><span class="co"># Note: columns are x and rows are y.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">downViewport</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"image"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/grid.lines.html" class="external-link">grid.lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">  default.units <span class="op">=</span> <span class="st">"native"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add a red box around rows 15 and 16</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">grid.rect</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">5.5</span>, width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">  just <span class="op">=</span> <span class="st">"left"</span>,</span>
<span class="r-in">  default.units <span class="op">=</span> <span class="st">"native"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## remove the viewports</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-10.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## put several pimages on a page (use grid viewports and newpage = FALSE)</span></span>
<span class="r-in"><span class="co"># set up grid layout</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">top_vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.layout.html" class="external-link">grid.layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span class="r-in">  widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.6</span><span class="op">)</span>, unit <span class="op">=</span> <span class="st">"npc"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">col1_vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>layout.pos.row <span class="op">=</span> <span class="fl">1</span>, layout.pos.col <span class="op">=</span> <span class="fl">1</span>, name <span class="op">=</span> <span class="st">"col1_vp"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">col2_vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>layout.pos.row <span class="op">=</span> <span class="fl">1</span>, layout.pos.col <span class="op">=</span> <span class="fl">2</span>, name <span class="op">=</span> <span class="st">"col2_vp"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">splot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">vpTree</a></span><span class="op">(</span><span class="va">top_vp</span>, <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">vpList</a></span><span class="op">(</span><span class="va">col1_vp</span>, <span class="va">col2_vp</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="va">splot</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">seekViewport</a></span><span class="op">(</span><span class="st">"col1_vp"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">x</span>, <span class="va">o</span>, labCol <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"Random Data"</span>,</span>
<span class="r-in">  newpage <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">seekViewport</a></span><span class="op">(</span><span class="st">"col2_vp"</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## add the reordered dissimilarity matrix for rows</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">pimage</span><span class="op">(</span><span class="va">d</span>, <span class="va">o</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, labCol <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"Random Data"</span>,</span>
<span class="r-in">  newpage <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">popViewport</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span class="r-plt img"><img src="pimage-11.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##-------------------------------------------------------------</span></span>
<span class="r-in"><span class="co">## ggplot2 Examples</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Logical Matrix</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">300</span>, rep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Matrix for logical values. TRUE values are dark. There are too many</span></span>
<span class="r-in"><span class="co"># Row labels (&gt;25) so they are suppressed.</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Show all labels and flip axes or reverse columns</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">x</span>, flip_axes <span class="op">=</span> <span class="cn">TRUE</span>, row_labels <span class="op">=</span> <span class="cn">TRUE</span>, col_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">x</span>, reverse_columns <span class="op">=</span> <span class="cn">TRUE</span>, row_labels <span class="op">=</span> <span class="cn">TRUE</span>, col_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Add lines</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.5</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Reorder matrix, use custom colors, add a title,</span></span>
<span class="r-in"><span class="co"># and hide colorkey.</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, row_labels <span class="op">=</span> <span class="cn">TRUE</span>, col_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey90"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Random Data"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Positive Matrix</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Random Data"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#' ## Example: Pos/Neg. Matrix</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">x</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Random Data"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Distance Matrix</span></span>
<span class="r-in"><span class="co"># Show a reordered distance matrix (distances between rows).</span></span>
<span class="r-in"><span class="co"># Dark means low distance. The aspect ratio is automatically fixed to 1:1.</span></span>
<span class="r-in"><span class="co"># The upper triangle is suppressed triangle</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">d</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Random Data"</span>, subtitle <span class="op">=</span> <span class="st">"Distances"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Show also upper triangle and diagonal</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">d</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, upper_tri <span class="op">=</span> <span class="cn">TRUE</span>, diag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Random Data"</span>, subtitle <span class="op">=</span> <span class="st">"Distances"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Show only distances that are smaller than 4 using limits on fill.</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">d</span>,  order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Random Data (Distances + Theshold)"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Correlation Matrix</span></span>
<span class="r-in"><span class="co"># we calculate correlation between rows and seriate the matrix</span></span>
<span class="r-in"><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="permute.html">permute</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">r</span>,  zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, upper <span class="op">=</span> <span class="cn">FALSE</span>, diag <span class="op">=</span> <span class="cn">FALSE</span>, reverse_columns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">col</span>, y <span class="op">=</span> <span class="va">row</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Random Data"</span>, subtitle <span class="op">=</span> <span class="st">"Correlation"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example: Custom themes and colors</span></span>
<span class="r-in"><span class="co"># Use ggplot2 themes with theme_set</span></span>
<span class="r-in"><span class="va">old_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">d</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Random Data (Distances)"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="va">old_theme</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use custom color palettes: Gray scale, Colorbrewer (provided in ggplot2) and colorspace</span></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">d</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, upper_tri <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"white"</span>, na.value <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">d</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, upper_tri <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, direction <span class="op">=</span> <span class="op">+</span><span class="fl">1</span>, na.value <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">ggpimage</span><span class="op">(</span><span class="va">d</span>, order <span class="op">=</span> <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, upper_tri <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/scale_colour_continuous_sequential.html" class="external-link">scale_fill_continuous_sequential</a></span><span class="op">(</span><span class="st">"Reds"</span>, rev <span class="op">=</span> <span class="cn">FALSE</span>, na.value <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> will replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> will replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> will replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> will replace the existing scale.</span>
<span class="r-plt img"><img src="pimage-12.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Hahsler, Christian Buchta, Kurt Hornik.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

