<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Tries to find an linear order for objects using data in form of a
dissimilarity matrix (two-way one mode data), a data matrix (two-way
two-mode data) or a data array (k-way k-mode data). The order can then be
used to reorder the dissimilarity matrix/data matrix using
permute()."><title>Seriate Dissimilarity Matrices, Matrices or Arrays — seriate • seriation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Seriate Dissimilarity Matrices, Matrices or Arrays — seriate"><meta property="og:description" content="Tries to find an linear order for objects using data in form of a
dissimilarity matrix (two-way one mode data), a data matrix (two-way
two-mode data) or a data array (k-way k-mode data). The order can then be
used to reorder the dissimilarity matrix/data matrix using
permute()."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">seriation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mhahsler/seriation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Seriate Dissimilarity Matrices, Matrices or Arrays</h1>
      <small class="dont-index">Source: <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/seriate.R" class="external-link"><code>R/seriate.R</code></a>, <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/seriate.array.R" class="external-link"><code>R/seriate.array.R</code></a>, <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/seriate.data.frame.R" class="external-link"><code>R/seriate.data.frame.R</code></a>, and 3 more</small>
      <div class="d-none name"><code>seriate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Tries to find an linear order for objects using data in form of a
dissimilarity matrix (two-way one mode data), a data matrix (two-way
two-mode data) or a data array (k-way k-mode data). The order can then be
used to reorder the dissimilarity matrix/data matrix using
<code><a href="permute.html">permute()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for array</span>
<span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"PCA"</span>, control <span class="op">=</span> <span class="cn">NULL</span>, margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for data.frame</span>
<span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"Heatmap"</span>, control <span class="op">=</span> <span class="cn">NULL</span>, margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for dist</span>
<span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"Spectral"</span>, control <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for matrix</span>
<span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"PCA"</span>, control <span class="op">=</span> <span class="cn">NULL</span>, margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for table</span>
<span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"CA"</span>, control <span class="op">=</span> <span class="cn">NULL</span>, margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>the data.</p></dd>


<dt>...</dt>
<dd><p>further arguments are added to the <code>control</code> list.</p></dd>


<dt>method</dt>
<dd><p>a character string with the name of the seriation method
(default: varies by data type).</p></dd>


<dt>control</dt>
<dd><p>a list of control options passed on to the seriation
algorithm.</p></dd>


<dt>margin</dt>
<dd><p>a vector giving the margin indices (dimensions) to be
seriated. For example, for a matrix, <code>1</code> indicates rows, <code>2</code>
indicates columns, <code>c(1,2)</code> indicates rows and columns. Unseriated margins return
a identity seriation order.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns an object of class <a href="ser_permutation.html">ser_permutation</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Seriation methods are managed via a registry. See
<code><a href="registry_seriate.html">list_seriation_methods()</a></code> for help. In the following, we discuss only the
built-in methods that are registered automatically by the package <span class="pkg">seriation</span>.</p>
<p>Many seriation methods (heuristically) optimize (minimize or maximize) an
objective function. The value of the function for a given seriation can be
calculated using <code><a href="criterion.html">criterion()</a></code>. In this manual page, we
include the measure which is optimized by each method using <strong>bold font</strong>.
If no measure is mentioned, then the measure does not directly optimize a measure.
A definition of the measures can be found in the <code><a href="criterion.html">criterion()</a></code> manual page.</p>
<p><strong>Seriation methods for distance matrices (dist)</strong></p>
<p>One-mode two-way data has to be provided as a dist object (not
as a symmetric matrix). Similarities have to be transformed into
dissimilarities. Currently, the following methods are implemented (for a
more detailed description and an experimental comparison see
<a href="https://michael.hahsler.net/research/paper/EJOR_seriation_2016.pdf" class="external-link">Hahsler (2017)</a>:</p><ul><li><p>"ARSA" Anti-Robinson seriation by simulated
annealing to minimize the <strong>linear seriation criterion</strong> (simulated
annealing initialization used in Brusco et al 2008).</p></li>
<li><p>"BBURCG" Anti-Robinson seriation by branch-and-bound to
minimize the <strong>unweighted gradient measure</strong> (Brusco and Stahl 2005).
This is only feasible for a relatively small number of objects.</p></li>
<li><p>"BBWRCG" Anti-Robinson seriation by branch-and-bound to
minimize the <strong>weighted gradient measure</strong> (Brusco and Stahl 2005). This
is only feasible for a relatively small number of objects.</p></li>
<li><p>"TSP" Traveling salesperson problem solver to minimize the
<strong>Hamiltonian path length</strong>. The solvers in <span class="pkg">TSP</span> are used (see
<code><a href="https://rdrr.io/pkg/TSP/man/solve_TSP.html" class="external-link">TSP::solve_TSP()</a></code>). The solver method can be passed on via the <code>control</code>
argument, e.g. <code>control = list(method = "two_opt")</code>. Default is the est
of 10 runs of arbitrary insertion heuristic with 2-opt improvement.</p>
<p>Since a tour returned by a TSP solver is a connected circle and we are
looking for a path representing a linear order, we need to find the best
cutting point.  Climer and Zhang (2006) suggest to add a dummy city with
equal distance to each other city before generating the tour. The place of
this dummy city in an optimal tour with minimal length is the best cutting
point (it lies between the most distant cities).</p></li>
<li><p>"R2E" Rank-two ellipse seriation (Chen 2002).</p>
<p>This method starts with generating a sequence of correlation matrices
\(R^1, R^2, \ldots\). \(R^1\) is the correlation matrix of the original
distance matrix \(D\) (supplied to the function as <code>x</code>), and
$$R^{n+1} = \phi R^n,$$ where \(\phi\) calculates the correlation
matrix.</p>
<p>The rank of the matrix \(R^n\) falls with increasing \(n\). The first
\(R^n\) in the sequence which has a rank of 2 is found. Projecting all
points in this matrix on the first two eigenvectors, all points fall on an
ellipse. The order of the points on this ellipse is the resulting order.</p>
<p>The ellipse can be cut at the two interception points (top or bottom) of the
vertical axis with the ellipse. In this implementation the top most cutting
point is used.</p></li>
<li><p>"MDS", "MDS_metric", "MDS_nonmetric", "MDS_angle" Multidimensional scaling (MDS).</p>
<p>Use multidimensional scaling techniques to find an linear order by
minimizing <strong>stress</strong>. Note MDS algorithms used for a single dimension
tend to end up in local optima and unidimensional scaling (see Maier and De
Leeuw, 2015) would be more appropriate. However, generally, ordering along
the first component of MDS provides good results.</p>
<p><code>control</code> parameters:</p><ul><li><p><code>method</code>: One of <code>"cmdscale"</code>, <code>"isoMDS"</code> or <code>"sammon"</code>. <code>"cmdscale"</code> performs metric
MDS using <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">stats::cmdscale()</a></code>. Non-metric MDS methods <code>"isoMDS"</code> and <code>"sammon"</code>
are preformed using <code><a href="https://rdrr.io/pkg/MASS/man/isoMDS.html" class="external-link">MASS::isoMDS()</a></code>.</p></li>
</ul><p>By default, metric MDS is used (<code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">stats::cmdscale()</a></code>). In case of
of general dissimilarities, non-metric MDS can be used. The method can be specified
as the element <code>method</code> (<code>"cmdscale"</code>, <code>"isoMDS"</code> or <code>"sammon"</code>) in <code>control</code>.</p>
<p>For convenience, seriation methods <code>"MDS_metric"</code> performs <code><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale()</a></code> and
<code>"MDS_nonmetric"</code> performs <code><a href="https://rdrr.io/pkg/MASS/man/isoMDS.html" class="external-link">MASS::isoMDS()</a></code>.</p>
<p><code>"MDS_angle"</code> projects the data on the first two components found by
MDS and then orders by the angle in this space. The order is split by the
larges gap between adjacent angles. A similar method was used for ordering
correlation matrices by Friendly (2002).</p></li>
<li><p>"HC", "HC_single", "HC_complete", "HC_average", "HC_ward" Hierarchical clustering.</p>
<p>Using the order of the leaf nodes in a dendrogram obtained by hierarchical
clustering can be used as a very simple seriation technique. This method
applies hierarchical clustering (<code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust()</a></code>) to <code>x</code>. The clustering
method can be given using a <code>"method"</code> element in the <code>control</code>
list. If omitted, the default <code>"average"</code> is used.</p>
<p>For convenience the other methods are provided as shortcuts.</p></li>
<li><p>"GW" Hierarchical clustering (Gruvaeus and Wainer, 1972).</p>
<p>The methods start with a dendrogram created by <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust()</a></code>. As the
<code>"method"</code> element in the <code>control</code> list a clustering method
(default <code>"average"</code>) can be specified. Alternatively, an <a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a>
object can be supplied using an element named <code>"hclust"</code>.</p>
<p>A dendrogram (binary tree) has \(2^{n-1}\) internal nodes (subtrees) and
the same number of leaf orderings. That is, at each internal node the left
and right subtree (or leaves) can be swapped, or, in terms of a dendrogram,
be flipped. The leaf-node reordering to minimize
<strong>Hamiltonian path length (restricted)</strong>.</p>
<p>Method <code>"GW"</code> uses an algorithm developed by Gruvaeus and Wainer (1972)
as implemented <code><a href="https://rdrr.io/pkg/gclus/man/hclust.html" class="external-link">gclus::reorder.hclust()</a></code> (Hurley 2004).  The clusters are
ordered at each level so that the objects at the edge of each cluster are
adjacent to that object outside the cluster to which it is nearest. The
method produces an unique order.</p>
<p>For convenience <code>"GW_single"</code>, <code>"GW_average"</code>,
<code>"GW_complete"</code>, and <code>"GW_ward"</code> are provided.</p></li>
<li><p>"OLO" Optimal leaf ordering (Bar-Joseph et al., 2001).</p>
<p>Also starts with a dendrogram and
produces an optimal leaf ordering with respect to the minimizing the sum of
the distances along the (Hamiltonian) path connecting the leaves in the
given order. The time complexity of the algorithm is \(O(n^3)\). Note that
non-finite distance values are not allowed.</p>
<p>For convenience <code>"OLO_single"</code>,
<code>"OLO_average"</code>, <code>"OLO_complete"</code>, and <code>"OLO_ward"</code> are provided.</p></li>
<li><p>"VAT" Visual Assessment of (Clustering) Tendency (Bezdek and Hathaway (2002)).</p>
<p>Creates an order based on Prim's algorithm for finding a minimum spanning
tree (MST) in a weighted connected graph representing the distance matrix.
The order is given by the order in which the nodes (objects) are added to
the MST.</p></li>
<li><p>"SA" Simulated Annealing for diverse criterion measures.</p>
<p>Implement simulated annealing similar to the ARSA method, however, it works
for any criterion measure defined in <span class="pkg">seriation</span>. By default the
algorithm optimizes for raw gradient measure and is warm started with the
result of spectral seriation (2-Sum problem) since Hahsler (2017) shows that
2-Sum solutions are similar to solutions for the gradient measure.</p>
<p>Several popular local neighborhood functions are
provided an new can be defined (see <a href="LS.html">LS</a>).</p>
<p>Note that this is an R implementation repeatedly calling criterion, and
therefore is relatively slow.</p></li>
<li><p>"Spectral", "Spectral_norm" Spectral seriation (Ding and He 2004).</p>
<p>Spectral seriation uses a relaxation to minimize the <strong>2-Sum Problem</strong>
(Barnard, Pothen, and Simon, 1993). It uses the order of the Fiedler vector
of the similarity matrix's (normalized) Laplacian.</p>
<p>Spectral seriation gives a good trade-off between seriation quality, speed
and scalability (see Hahsler, 2017).</p></li>
<li><p>"SPIN_STS", "SPIN_NH" Sorting Points Into Neighborhoods (SPIN) (Tsafrir 2005).</p>
<p>Given a weight matrix \(W\), the algorithms try to
minimize the energy for a permutation (matrix \(P\)) given by $$F(P) =
  tr(PDP^TW),$$ where \(tr\) denotes the matrix trace.</p>
<p><code>"SPIN_STS"</code> implements the Side-to-Side algorithm which tries to push
out large distance values. The default weight matrix suggested in the paper
with \(W=XX^T\) and \(X_i=i-(n+1)/2\) is used. We run the algorithm from
<code>step</code> (25) iteration and restart the algorithm <code>nstart</code> (10) with
random initial permutations (default values in parentheses). Via
<code>control</code> the parameters <code>step</code>, <code>nstart</code>, <code>X</code> and
<code>verbose</code>.</p>
<p><code>"SPIN_NH"</code> implements the neighborhood algorithm (concentrate low
distance values around the diagonal) with a Gaussian weight matrix
\(W_{ij} = exp(-(i-j)^2/n\sigma)\), where \(n\) is the size of the
dissimilarity matrix and \(\sigma\) is the variance around the diagonal
that control the influence of global (large \(\sigma\)) or local (small
\(\sigma\)) structure.</p>
<p>We use the heuristic suggested in the paper for the linear assignment
problem. We do not terminate as indicated in the algorithm, but run all the
iterations since the heuristic does not guarantee that the energy is
strictly decreasing. We also implement the heuristic "annealing" scheme
where \(\sigma\) is successively reduced. The parameters in <code>control</code>
are <code>sigma</code> which can be a single value or a decreasing sequence
(default: 20 to 1 in 10 steps) and <code>step</code> which defines how many update
steps are performed before for each value of <code>alpha</code>. Via
<code>W_function</code> a custom function to create \(W\) with the function
signature <code>function(n, sigma, verbose)</code> can be specified. The parameter
<code>verbose</code> can be used to display progress information.</p></li>
<li><p>"QAP_LS", "QAP_2SUM", "QAP_BAR", "QAP_Inertia" Quadratic assignment problem
formulations for seriation using a simulated annealing solver.</p>
<p>These methods minimize the
<strong>Linear Seriation Problem</strong> (LS) formulation (Hubert and Schultz 1976),
the <strong>2-Sum Problem</strong> formulation (Barnard, Pothen, and Simon 1993), the
<strong>banded anti-Robinson form</strong> (BAR) or the <strong>inertia criterion.</strong></p>
<p><code>control</code> parameters are passed on to <code><a href="https://rdrr.io/pkg/qap/man/qap.html" class="external-link">qap::qap()</a></code>.
An important parameter is <code>rep</code> to return the best result out of the
given number of repetitions with random restarts. Default is 1, but bigger
numbers result in better and more stable results.</p></li>
<li><p>"GA" Use a genetic algorithm to optimize for various criteria.</p>
<p>The GA code has to be first registered. A detailed description can
be found in the manual page for <code><a href="register_GA.html">register_GA()</a></code>.</p></li>
<li><p>"DendSer" Use heuristic dendrogram seriation to optimize for various criteria.</p>
<p>The DendSer code has to be first registered. A
detailed description can be found in the manual page for
<code><a href="register_DendSer.html">register_DendSer()</a></code>.</p></li>
<li><p>"Identity" Produces an identity permutation.</p></li>
<li><p>"Random"  Produces a random permutation.</p></li>
</ul><p><strong>Seriation methods for matrices (matrix or data.frame)</strong></p>
<p>Two-mode two-way data are general matrices.
Some methods also require that the matrix is positive. Data frames are just a
different representation of a matrix and all seriation methods for matrix can
be also used for data frames. The default method for data frames is heatmap
seriation which calculates distances between rows and between columns and
then applies seriation on these using hierarchical clustering and optimal
leaf ordering (OLO).</p>
<p>Currently the
following methods are implemented for matrix:</p><ul><li><p>"BEA" Bond Energy Algorithm (BEA; McCormick 1972).</p>
<p>The algorithm tries to maximize the <strong>Measure of Effectiveness.</strong> of a
non-negative matrix. Due to the definition of this measure, the tasks of
ordering rows and columns is separable and can be solved independently.</p>
<p>A row is arbitrarily placed; then rows are positioned one by one. When this
is completed, the columns are treated similarly. The overall procedure
amounts to two approximate traveling salesperson problems (TSP), one on the
rows and one on the columns. The so-called `best insertion strategy' is
used: rows (or columns) are inserted into the current permuted list of rows
(or columns). Several consecutive runs of the algorithm might improve the
energy.</p>
<p>Note that Arabie and Hubert (1990) question its use with non-binary data if
the objective is to find a seriation or one-dimensional orderings of rows
and columns.</p>
<p>The BEA code used in this package was implemented by Fionn Murtagh.</p>
<p><code>control</code> parameter:</p><ul><li><p><code>"rep"</code>: the number of runs can be specified.
The results of the best run will be returned.</p></li>
</ul></li>
<li><p>"BEA_TSP" Use a TSP to optimize the <strong>Measure of Effectiveness</strong> (Lenstra 1974).</p>
<p><code>control</code> parameter:</p><ul><li><p><code>"method"</code>: a TSP solver method (see <code><a href="https://rdrr.io/pkg/TSP/man/solve_TSP.html" class="external-link">TSP::solve_TSP()</a></code>).</p></li>
</ul></li>
<li><p>"CA" Correspondence analysis for a table/matrix of frequencies.</p>
<p>This function is designed to help simplify a mosaic plot or other displays of a
matrix of frequencies.  It calculates a correspondence analysis of the matrix and
an order for rows and columns according to the scores on a correspondence analysis dimension.</p>
<p><code>control</code> parameters:</p><ul><li><p><code>"dim"</code>: CA dimension used for reordering.</p></li>
<li><p><code>"ca_param"</code>: List with parameters for the call to <code><a href="https://rdrr.io/pkg/ca/man/ca.html" class="external-link">ca::ca()</a></code>.</p></li>
</ul></li>
<li><p>"Heatmap" Heatmap seriation</p>
<p>Calculates distances between
rows and between columns and then applies seriation on these using
hierarchical clustering and optimal leaf ordering (method <code>"OLO"</code> for distance matrices).</p></li>
<li><p>"PCA" Order by the first principal component.</p>
<p>Uses the projection of the data on its first principal component to
determine the order.</p>
<p>Note that for a distance matrix calculated from <code>x</code> with Euclidean
distance, this methods minimizes the least square criterion.</p></li>
<li><p>"PCA_angle" Order using the first two principal components.</p>
<p>Projects the data on the first two principal components
and then orders by the angle in this space. The order is split by the larges
gap between adjacent angles. A similar method was used for ordering
correlation matrices by Friendly (2002).</p></li>
<li><p>"Identity" Produces an identity permutation.</p></li>
<li><p>"Random" Produces a random permutation.</p></li>
</ul><p>For <strong>general arrays</strong> no built-in methods are currently available.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Arabie, P. and L.J. Hubert (1990): The bond energy algorithm
revisited, <em>IEEE Transactions on Systems, Man, and Cybernetics,</em>
<b>20</b>(1), 268--274.
<a href="https://doi.org/10.1109/21.47829" class="external-link">doi:10.1109/21.47829</a></p>
<p>Bar-Joseph, Z., E. D. Demaine, D. K. Gifford, and T. Jaakkola. (2001): Fast
Optimal Leaf Ordering for Hierarchical Clustering. <em>Bioinformatics,</em>
<b>17</b>(1), 22--29.
<a href="https://doi.org/10.1093/bioinformatics/17.suppl_1.S22" class="external-link">doi:10.1093/bioinformatics/17.suppl_1.S22</a></p>
<p>Barnard, S. T., A. Pothen, and H. D. Simon (1993): A Spectral Algorithm for
Envelope Reduction of Sparse Matrices. <em>In Proceedings of the 1993
ACM/IEEE Conference on Supercomputing,</em> 493--502. Supercomputing '93. New
York, NY, USA: ACM. <a href="https://ieeexplore.ieee.org/document/1263497" class="external-link">https://ieeexplore.ieee.org/document/1263497</a></p>
<p>Bezdek, J.C. and Hathaway, R.J. (2002): VAT: a tool for visual assessment of
(cluster) tendency. <em>Proceedings of the 2002 International Joint
Conference on Neural Networks (IJCNN '02)</em>, Volume: 3, 2225--2230.
<a href="https://doi.org/10.1109/IJCNN.2002.1007487" class="external-link">doi:10.1109/IJCNN.2002.1007487</a></p>
<p>Brusco, M., Koehn, H.F., and Stahl, S. (2008): Heuristic Implementation of
Dynamic Programming for Matrix Permutation Problems in Combinatorial Data
Analysis. <em>Psychometrika,</em> <b>73</b>(3), 503--522.
<a href="https://doi.org/10.1007/s11336-007-9049-5" class="external-link">doi:10.1007/s11336-007-9049-5</a></p>
<p>Brusco, M., and Stahl, S. (2005): <em>Branch-and-Bound Applications in
Combinatorial Data Analysis.</em> New York: Springer.
<a href="https://doi.org/10.1007/0-387-28810-4" class="external-link">doi:10.1007/0-387-28810-4</a></p>
<p>Chen, C. H. (2002): Generalized Association Plots: Information Visualization
via Iteratively Generated Correlation Matrices. <em>Statistica Sinica,</em>
<b>12</b>(1), 7--29.</p>
<p>Ding, C. and Xiaofeng He (2004): Linearized cluster assignment via spectral
ordering. <em>Proceedings of the Twenty-first International Conference on
Machine learning (ICML '04)</em>.
<a href="https://doi.org/10.1145/1015330.1015407" class="external-link">doi:10.1145/1015330.1015407</a></p>
<p>Climer, S. and Xiongnu Zhang (2006): Rearrangement Clustering: Pitfalls,
Remedies, and Applications, <em>Journal of Machine Learning Research,</em>
<b>7</b>(Jun), 919--943.</p>
<p>Friendly, M. (2002): Corrgrams: Exploratory Displays for Correlation
Matrices. <em>The American Statistician</em>, <b>56</b>(4), 316--324.
<a href="https://doi.org/10.1198/000313002533" class="external-link">doi:10.1198/000313002533</a></p>
<p>Gruvaeus, G. and Wainer, H. (1972): Two Additions to Hierarchical Cluster
Analysis, <em>British Journal of Mathematical and Statistical Psychology,</em>
<b>25</b>, 200--206.
<a href="https://doi.org/10.1111/j.2044-8317.1972.tb00491.x" class="external-link">doi:10.1111/j.2044-8317.1972.tb00491.x</a></p>
<p>Hahsler, M. (2017): An experimental comparison of seriation methods for
one-mode two-way data. <em>European Journal of Operational Research,</em>
<b>257</b>, 133--143.
<a href="https://doi.org/10.1016/j.ejor.2016.08.066" class="external-link">doi:10.1016/j.ejor.2016.08.066</a></p>
<p>Hubert, Lawrence, and James Schultz (1976): Quadratic Assignment as a
General Data Analysis Strategy. <em>British Journal of Mathematical and
Statistical Psychology</em> <b>29</b>(2). Blackwell Publishing Ltd. 190--241.
<a href="https://doi.org/10.1111/j.2044-8317.1976.tb00714.x" class="external-link">doi:10.1111/j.2044-8317.1976.tb00714.x</a></p>
<p>Hurley, Catherine B. (2004): Clustering Visualizations of Multidimensional
Data. <em>Journal of Computational and Graphical Statistics,</em>
<b>13</b>(4), 788--806.
<a href="https://doi.org/10.1198/106186004X12425" class="external-link">doi:10.1198/106186004X12425</a></p>
<p>Lenstra, J.K (1974): Clustering a Data Array and the Traveling-Salesman
Problem, <em>Operations Research,</em> <b>22</b>(2) 413--414.
<a href="https://doi.org/10.1287/opre.22.2.413" class="external-link">doi:10.1287/opre.22.2.413</a></p>
<p>Mair P., De Leeuw J. (2015). Unidimensional scaling. In <em>Wiley
StatsRef: Statistics Reference Online,</em> Wiley, New York.
<a href="https://doi.org/10.1002/9781118445112.stat06462.pub2" class="external-link">doi:10.1002/9781118445112.stat06462.pub2</a></p>
<p>McCormick, W.T., P.J. Schweitzer and T.W. White (1972): Problem
decomposition and data reorganization by a clustering technique,
<em>Operations Research,</em> <b>20</b>(5), 993--1009.
<a href="https://doi.org/10.1287/opre.20.5.993" class="external-link">doi:10.1287/opre.20.5.993</a></p>
<p>Tsafrir, D., Tsafrir, I., Ein-Dor, L., Zuk, O., Notterman, D.A. and Domany,
E. (2005): Sorting points into neighborhoods (SPIN): data analysis and
visualization by ordering distance matrices, <em>Bioinformatics,</em>
<b>21</b>(10) 2301--8.
<a href="https://doi.org/10.1093/bioinformatics/bti329" class="external-link">doi:10.1093/bioinformatics/bti329</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other seriation: 
<code><a href="register_DendSer.html">register_DendSer</a>()</code>,
<code><a href="register_GA.html">register_GA</a>()</code>,
<code><a href="register_optics.html">register_optics</a>()</code>,
<code><a href="register_tsne.html">register_tsne</a>()</code>,
<code><a href="register_umap.html">register_umap</a>()</code>,
<code><a href="registry_seriate.html">registry_seriate</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Hahsler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Show available seriation methods (for dist and matrix)</span></span>
<span class="r-in"><span class="fu"><a href="registry_seriate.html">list_seriation_methods</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $array</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Identity" "Random"   "Reverse" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "ARSA"          "BBURCG"        "BBWRCG"        "GW"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "GW_average"    "GW_complete"   "GW_single"     "GW_ward"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "HC"            "HC_average"    "HC_complete"   "HC_single"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "HC_ward"       "Identity"      "MDS"           "MDS_angle"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "MDS_metric"    "MDS_nonmetric" "OLO"           "OLO_average"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "OLO_complete"  "OLO_single"    "OLO_ward"      "QAP_2SUM"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "QAP_BAR"       "QAP_Inertia"   "QAP_LS"        "R2E"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] "Random"        "SA"            "SPIN_NH"       "SPIN_STS"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] "Spectral"      "Spectral_norm" "TSP"           "VAT"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BEA"       "BEA_TSP"   "CA"        "Heatmap"   "Identity"  "PCA"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "PCA_angle" "Random"    "Reverse"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### Seriate as distance matrix (for the iris dataset)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu">seriate</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span class="r-in"><span class="va">order</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> object of class ‘ser_permutation’, ‘list’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> contains permutation vectors for 1-mode data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector length seriation method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           150         Spectral</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">d</span>, main <span class="op">=</span> <span class="st">"Distances (Random Order)"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">order</span>, main <span class="op">=</span> <span class="st">"Distances (Reordered)"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compare seriation quality</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span class="r-in">        random <span class="op">=</span> <span class="fu"><a href="criterion.html">criterion</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>,</span>
<span class="r-in">        reordered <span class="op">=</span> <span class="fu"><a href="criterion.html">criterion</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-in">     <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               2SUM AR_deviations AR_events       BAR      Cor_R Gradient_raw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> random    30468963    966223.582    558784 165955.60 0.01263096       -15483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reordered 17821593      9887.392     54924  56609.97 0.37195391       992058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Gradient_weighted   Inertia      LS Lazy_path_length Least_squares</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> random            -32636.37 211686682 5690074        29646.303      78893988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reordered        1771427.16 356910343 4487365         6705.889      76488569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 ME Moore_stress Neumann_stress Path_length       RGAR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> random    5879.489    11833.839      5985.8554   389.49727 0.50678759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reordered 7253.697     1111.651       538.7757    91.28657 0.04981317</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Reorder the distance matrix</span></span>
<span class="r-in"><span class="va">d_reordered</span> <span class="op">&lt;-</span>  <span class="fu"><a href="permute.html">permute</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">d_reordered</span>, main <span class="op">=</span> <span class="st">"Distances (Reordered)"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### Seriate a matrix</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># To make the variables comparable, we scale the data</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">x</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The iris flowers are ordered by species in the data set</span></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">x</span>, main <span class="op">=</span> <span class="st">"original data"</span>, prop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="criterion.html">criterion</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Cor_R        DiagSum             ME   Moore_stress Neumann_stress </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0.2137794      2.2822249   1005.9980469    357.1093200    133.6494969 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Apply some methods</span></span>
<span class="r-in"><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"BEA_TSP"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, main <span class="op">=</span> <span class="st">"TSP to optimize ME"</span>, prop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="criterion.html">criterion</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Cor_R        DiagSum             ME   Moore_stress Neumann_stress </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.01660821     2.02965361  1026.81396484   167.28938180    59.12345189 </span>
<span class="r-in"></span>
<span class="r-in"><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, main <span class="op">=</span> <span class="st">"First principal component"</span>, prop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="criterion.html">criterion</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Cor_R        DiagSum             ME   Moore_stress Neumann_stress </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0.2651909      2.1515976   1021.4874878    175.8500473     67.4722984 </span>
<span class="r-in"></span>
<span class="r-in"><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu">seriate</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, main <span class="op">=</span> <span class="st">"Heatmap seriation"</span>, prop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="criterion.html">criterion</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Cor_R        DiagSum             ME   Moore_stress Neumann_stress </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.2615153      2.8061108   1023.0682983    165.7717428     58.9144525 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># reorder the matrix</span></span>
<span class="r-in"><span class="va">x_reordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="permute.html">permute</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># create a heatmap seriation manually by calculating</span></span>
<span class="r-in"><span class="co"># distances between rows and between columns</span></span>
<span class="r-in"><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="fu">seriate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"OLO"</span><span class="op">)</span>,</span>
<span class="r-in">    <span class="fu">seriate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"OLO"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, main <span class="op">=</span> <span class="st">"Heatmap seriation"</span>, prop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="criterion.html">criterion</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Cor_R        DiagSum             ME   Moore_stress Neumann_stress </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.2615153      2.8061108   1023.0682983    165.7717428     58.9144525 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">### Seriate a correlation matrix</span></span>
<span class="r-in"><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">corr</span>, upper_tri <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"Correlation matrix"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-9.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># we need to define a distance (we used d = sqrt(2(1 - r))) and</span></span>
<span class="r-in"><span class="co"># then reorder the matrix (rows and columns).</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">corr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">seriate</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span class="r-in"><span class="va">corr_reordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="permute.html">permute</a></span><span class="op">(</span><span class="va">corr</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">o</span>, <span class="va">o</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pimage.html">pimage</a></span><span class="op">(</span><span class="va">corr_reordered</span>, upper_tri <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"Correlation matrix (reordered)"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="seriate-10.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Hahsler, Christian Buchta, Kurt Hornik.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

