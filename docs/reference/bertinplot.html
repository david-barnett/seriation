<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plot a data matrix of cases and variables. Each value is represented by a
symbol. Large values are highlighted. Note that Bertin arranges the cases
horizontally and the variables as rows. The matrix can be rearranged using
seriation techniques to make structure in the data visible (see Falguerolles
et al 1997)."><title>Plot a Bertin Matrix — bertinplot • seriation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a Bertin Matrix — bertinplot"><meta property="og:description" content="Plot a data matrix of cases and variables. Each value is represented by a
symbol. Large values are highlighted. Note that Bertin arranges the cases
horizontally and the variables as rows. The matrix can be rearranged using
seriation techniques to make structure in the data visible (see Falguerolles
et al 1997)."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">seriation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mhahsler/seriation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Plot a Bertin Matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/bertinplot.R" class="external-link"><code>R/bertinplot.R</code></a>, <a href="https://github.com/mhahsler/seriation/blob/HEAD/R/ggbertinplot.R" class="external-link"><code>R/ggbertinplot.R</code></a></small>
      <div class="d-none name"><code>bertinplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot a data matrix of cases and variables. Each value is represented by a
symbol. Large values are highlighted. Note that Bertin arranges the cases
horizontally and the variables as rows. The matrix can be rearranged using
seriation techniques to make structure in the data visible (see Falguerolles
et al 1997).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">bertinplot</span><span class="op">(</span>
  <span class="va">x</span>,
  order <span class="op">=</span> <span class="cn">NULL</span>,
  panel.function <span class="op">=</span> <span class="va">panel.bars</span>,
  highlight <span class="op">=</span> <span class="cn">TRUE</span>,
  row_labels <span class="op">=</span> <span class="cn">TRUE</span>,
  col_labels <span class="op">=</span> <span class="cn">TRUE</span>,
  flip_axes <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">panel.bars</span><span class="op">(</span><span class="va">value</span>, <span class="va">spacing</span>, <span class="va">hl</span><span class="op">)</span>

<span class="fu">panel.circles</span><span class="op">(</span><span class="va">value</span>, <span class="va">spacing</span>, <span class="va">hl</span><span class="op">)</span>

<span class="fu">panel.rectangles</span><span class="op">(</span><span class="va">value</span>, <span class="va">spacing</span>, <span class="va">hl</span><span class="op">)</span>

<span class="fu">panel.squares</span><span class="op">(</span><span class="va">value</span>, <span class="va">spacing</span>, <span class="va">hl</span><span class="op">)</span>

<span class="fu">panel.tiles</span><span class="op">(</span><span class="va">value</span>, <span class="va">spacing</span>, <span class="va">hl</span><span class="op">)</span>

<span class="fu">panel.blocks</span><span class="op">(</span><span class="va">value</span>, <span class="va">spacing</span>, <span class="va">hl</span><span class="op">)</span>

<span class="fu">panel.lines</span><span class="op">(</span><span class="va">value</span>, <span class="va">spacing</span>, <span class="va">hl</span><span class="op">)</span>

<span class="fu">bertin_cut_line</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>

<span class="fu">ggbertinplot</span><span class="op">(</span>
  <span class="va">x</span>,
  order <span class="op">=</span> <span class="cn">NULL</span>,
  geom <span class="op">=</span> <span class="st">"bar"</span>,
  highlight <span class="op">=</span> <span class="cn">TRUE</span>,
  row_labels <span class="op">=</span> <span class="cn">TRUE</span>,
  col_labels <span class="op">=</span> <span class="cn">TRUE</span>,
  flip_axes <span class="op">=</span> <span class="cn">TRUE</span>,
  prop <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a data matrix. Note that following Bertin, columns are variables
and rows are cases. This behavior can be reversed using <code>reverse = TRUE</code>
in <code>options</code>.</p></dd>


<dt>order</dt>
<dd><p>an object of class <code>ser_permutation</code> to rearrange <code>x</code>
before plotting.  If <code>NULL</code>, no rearrangement is performed.</p></dd>


<dt>panel.function</dt>
<dd><p>a function to produce the symbols. Currently available
functions are <code>panel.bars</code> (default), <code>panel.circles</code>,
<code>panel.rectangles</code>, <code>panel.tiles</code> and <code>panel.lines</code>. For
circles and squares neg. values are represented by a dashed border. For
blocks all blocks are the same size (can be used with <code>shading = TRUE</code>).</p></dd>


<dt>highlight</dt>
<dd><p>a logical scalar indicating whether to use highlighting.
If <code>TRUE</code>, all variables with values greater than the variable-wise
mean are highlighted. To control highlighting, also a logical matrix or a
matrix with colors with the same dimensions as <code>x</code> can be supplied.</p></dd>


<dt>row_labels, col_labels</dt>
<dd><p>a logical indicating if row and column labels
in <code>x</code> should be displayed.  If <code>NULL</code> then labels are displayed
if the <code>x</code> contains the appropriate dimname and the number of labels is
25 or less. A character vector of the appropriate length with labels can
also be supplied.</p></dd>


<dt>flip_axes</dt>
<dd><p>logical indicating whether to swap cases and variables in
the plot. The default (<code>TRUE</code>) is to plot cases as columns and
variables as rows.</p></dd>


<dt>...</dt>
<dd><p><code>ggbertinplot()</code>: further parameters are passed on to <code><a href="pimage.html">ggpimage()</a></code>.</p>
<p><code>bertinplot()</code>: further parameters can include:</p><ul><li><p><code>xlab, ylab</code> labels (default: use labels from <code>x</code>).</p></li>
<li><p><code>spacing</code> relative space between symbols (default: 0.2).</p></li>
<li><p><code>shading</code> use gray shades to encode value instead of
highlighting (default: <code>FALSE</code>).</p></li>
<li><p><code>shading.function</code> a function that accepts a single argument in range \([.1, .8]\)
and returns a valid corresponding color (e.g., using <code><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb()</a></code>).</p></li>
<li><p><code>frame</code> plot a grid to separate symbols (default: <code>FALSE</code>).</p></li>
<li><p><code>mar</code> margins (see <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code>).</p></li>
<li><p><code>gp_labels</code> <code>gpar</code> object for labels (see <code>gpar()</code>)</p></li>
<li><p><code>gp_panels</code> <code>gpar</code> object for panels (see <code>gpar()</code>).</p></li>
<li><p><code>newpage</code> a logical indicating whether to start
the plot on a new page (see <code>grid.newpage()</code>).</p></li>
<li><p><code>pop</code> a logical indicating whether to pop the created viewports
(see <code>pop.viewport()</code>)?</p></li>
</ul></dd>


<dt>value, spacing, hl</dt>
<dd><p>are used internally for the panel functions.</p></dd>


<dt>col, y</dt>
<dd><p>and x in <code>bertin_cut_line()</code> are for adding a line to a <code>bertinplot()</code> (not ggplot2-based).</p></dd>


<dt>geom</dt>
<dd><p>visualization type. Available ggplot2 geometries are: <code>"tile"</code>,
<code>"rectangle"</code>, <code>"circle"</code>, <code>"line"</code>, <code>"bar"</code>, <code>"none"</code>.</p></dd>


<dt>prop</dt>
<dd><p>logical; change the aspect ratio so cells in the image have a
equal width and height.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Nothing.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The plot is organized as a matrix of symbols. The symbols are drawn by a
panel function, where all symbols of a row are drawn by one call of the
function (using vectorization). The interface for the panel function is
<code>panel.myfunction(value, spacing, hl)</code>. <code>value</code> is the vector of
values for a row scaled between 0 and 1, <code>spacing</code> contains the
relative space between symbols and <code>hl</code> is a logical vector indicating
which symbol should be highlighted.</p>
<p>Cut lines can be added to an existing Bertin plot using
<code>bertin_cut_line(x = NULL, y = NULL)</code>. <code>x</code>/<code>y</code> is can be a
number indicating where to draw the cut line between two columns/rows. If
both <code>x</code> and <code>y</code> is specified then one can select a row/column and
the other can select a range to draw a line which does only span a part of
the row/column. It is important to call <code>bertinplot()</code> with the option
<code>pop = FALSE</code>.</p>
<p><code>ggbertinplot()</code> calls <code><a href="pimage.html">ggpimage()</a></code> and all additional parameters are
passed on.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>de Falguerolles, A., Friedrich, F., Sawitzki, G. (1997): A
Tribute to J. Bertin's Graphical Data Analysis. In: Proceedings of the
SoftStat '97 (Advances in Statistical Software 6), 11--20.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other plots: 
<code><a href="VAT.html">VAT</a>()</code>,
<code><a href="dissplot.html">dissplot</a>()</code>,
<code><a href="hmap.html">hmap</a>()</code>,
<code><a href="palette.html">palette</a>()</code>,
<code><a href="pimage.html">pimage</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Hahsler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Irish"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">scale_by_rank</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="va">rank</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">scale_by_rank</span><span class="op">(</span><span class="va">Irish</span><span class="op">[</span>,<span class="op">-</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use the the sum of absolute rank differences</span></span>
<span class="r-in"><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"minkowski"</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  <span class="fu"><a href="seriate.html">seriate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"minkowski"</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot</span></span>
<span class="r-in"><span class="fu">bertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-plt img"><img src="bertinplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Some alternative displays</span></span>
<span class="r-in"><span class="fu">bertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, panel <span class="op">=</span> <span class="va">panel.tiles</span>, shading_col <span class="op">=</span> <span class="fu"><a href="palette.html">bluered</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, highlight <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="bertinplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">bertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, panel <span class="op">=</span> <span class="va">panel.circles</span>, spacing <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span><span class="op">)</span></span>
<span class="r-plt img"><img src="bertinplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">bertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, panel <span class="op">=</span> <span class="va">panel.rectangles</span><span class="op">)</span></span>
<span class="r-plt img"><img src="bertinplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">bertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, panel <span class="op">=</span> <span class="va">panel.lines</span><span class="op">)</span></span>
<span class="r-plt img"><img src="bertinplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot with cut lines (we manually set the order here)</span></span>
<span class="r-in"><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu"><a href="ser_permutation.html">ser_permutation</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">16</span>, <span class="fl">19</span>, <span class="fl">18</span>, <span class="fl">14</span>, <span class="fl">12</span>, <span class="fl">20</span>, <span class="fl">15</span>,</span>
<span class="r-in">    <span class="fl">17</span>, <span class="fl">26</span>, <span class="fl">13</span>, <span class="fl">41</span>,  <span class="fl">7</span>, <span class="fl">11</span>, <span class="fl">5</span>, <span class="fl">23</span>, <span class="fl">28</span>, <span class="fl">34</span>, <span class="fl">31</span>, <span class="fl">1</span>, <span class="fl">38</span>, <span class="fl">40</span>,</span>
<span class="r-in">    <span class="fl">3</span>, <span class="fl">39</span>,  <span class="fl">4</span>, <span class="fl">27</span>, <span class="fl">24</span>,  <span class="fl">8</span>, <span class="fl">37</span>, <span class="fl">36</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">33</span>, <span class="fl">35</span>,  <span class="fl">2</span>,</span>
<span class="r-in">    <span class="fl">22</span>, <span class="fl">32</span>, <span class="fl">29</span>, <span class="fl">10</span>,  <span class="fl">6</span>,  <span class="fl">9</span><span class="op">)</span>,</span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">bertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, pop<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">bertin_cut_line</span><span class="op">(</span>, <span class="fl">4</span><span class="op">)</span> <span class="co">## horizontal line between rows 4 and 5</span></span>
<span class="r-in"><span class="fu">bertin_cut_line</span><span class="op">(</span>, <span class="fl">7</span><span class="op">)</span> <span class="co">## separate "Right to Life" from the rest</span></span>
<span class="r-in"><span class="fu">bertin_cut_line</span><span class="op">(</span><span class="fl">14</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co">## separate a block of large values (vertically)</span></span>
<span class="r-plt img"><img src="bertinplot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># ggplot2-based plots</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Default plot uses bars and highlighting values larger than the mean</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># highlight values in the 4th quartile</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Use different geoms. "none" lets the user specify their own geom.</span></span>
<span class="r-in">  <span class="co"># Variables set are row, col and x (for the value).</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, geom <span class="op">=</span> <span class="st">"tile"</span>, prop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, geom <span class="op">=</span> <span class="st">"rectangle"</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, geom <span class="op">=</span> <span class="st">"rectangle"</span>, prop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, geom <span class="op">=</span> <span class="st">"circle"</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, geom <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Tiles with diverging color scale</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, geom <span class="op">=</span> <span class="st">"tile"</span>, prop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>midpoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Custom geom (geom = "none"). Defined variables are row, col, and x for the value</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, geom <span class="op">=</span> <span class="st">"none"</span>, prop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">col</span>, y <span class="op">=</span> <span class="va">row</span>, size <span class="op">=</span> <span class="va">x</span>, color <span class="op">=</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">30</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># Use a ggplot2 theme with theme_set()</span></span>
<span class="r-in">  <span class="va">old_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">)</span></span>
<span class="r-in">  <span class="fu">ggbertinplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">order</span>, geom <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="va">old_theme</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> will replace the existing scale.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Hahsler, Christian Buchta, Kurt Hornik.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

